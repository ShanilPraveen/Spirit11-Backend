generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id          String   @id @default(uuid())
  username    String   @unique
  keycloakId  String   @unique
  role        String
  team        Team?    @relation(fields: [teamId], references: [id])
  teamId      String?
}


model Player {
  id          String   @id @default(uuid())
  name        String
  university  String
  position    String
  value       Int
  stat        Stat?    @relation(fields: [statId], references: [id])
  statId      String?
  teamPlayers TeamPlayer[]
}


model Stat {
  id       String   @id @default(uuid())
  runs     Int
  wickets  Int
  player   Player?  @relation(fields: [playerId], references: [id])
  playerId String?
}


model Team {
  id         String   @id @default(uuid())
  user       User     @relation(fields: [userId], references: [id])
  userId     String   @unique
  players    TeamPlayer[]
  createdAt  DateTime @default(now())
}


model TeamPlayer {
  id        String   @id @default(uuid())
  team      Team     @relation(fields: [teamId], references: [id])
  teamId    String
  player    Player   @relation(fields: [playerId], references: [id])
  playerId  String
  addedAt   DateTime @default(now())

  @@unique([teamId, playerId])
}